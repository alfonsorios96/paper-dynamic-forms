<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<link rel="import" href="../paper-dynamic-forms.html">

<dom-module id="demo-element">
    <template>
        <style is="custom-style" include="demo-pages-shared-styles">
        </style>

        <iron-ajax
                auto
                url="data.json"
                handle-as="json"
                on-response="handleResponse"
                debounce-duration="300"></iron-ajax>

        <div class="vertical-section-container centered">
            <h3>Basic demo for paper-dynamic-forms</h3>
            <demo-snippet>
                <paper-dynamic-forms type="option-input"
                                     sentences="[[responseRequest.inputOption]]"
                                     on-option-input-response="handler"></paper-dynamic-forms>
                <paper-dynamic-forms type="text-input" sentences="[[responseRequest.inputText]]"
                                     on-text-input-response="handler"></paper-dynamic-forms>
                <paper-button on-tap="createField">Create form field</paper-button>
                <hr>
                <h2>Your awesome form</h2>
                <paper-dynamic-forms
                        type="[[type]]"
                        sentences="[[sentences]]"></paper-dynamic-forms>
            </demo-snippet>
        </div>
    </template>

    <script>
        'use strict';
        (function PaperDynamicFormsDefinition(customElements) {
            /**
             * `paper-dynamic-forms`
             * This component gives a easy and comfortable way to magives a easy and comfortable way to make dynamics prohectske dynamics projects. E.g. polls
             *
             * @customElement
             * @polymer
             * @demo demo/index.html
             */
            class DemoElement extends Polymer.Element {
                static get is() {
                    return 'demo-element';
                }

                static get properties() {
                    return {
                        responseRequest: Object,
                        type: String,
                        sentence: Object,
                        sentences: {
                            type: Array,
                            value: []
                        }
                    }
                }

                handleResponse(event) {
                    this.set('responseRequest', event.detail.response);
                }

                createField() {
                    this.push('sentences', this.sentence);
                }

                handler(payload) {
                    if (payload.detail.model.sentence.label === 'Select a form type') {
                        this.set('type', payload.detail.option);
                    }
                    if (payload.detail.model.sentence.label === 'Input a label for your form field') {
                        this.set('sentence', {
                            label: payload.detail.option
                        });
                    }
                }
            }

            customElements.define(DemoElement.is, DemoElement);
        })(window.customElements);
    </script>
</dom-module>