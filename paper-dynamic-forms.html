<link rel="import" href="../polymer/polymer-element.html">

<link rel="import" href="../polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../polymer/lib/elements/dom-if.html">

<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">


<dom-module id="paper-dynamic-forms">
    <template>
        <template is="dom-if" if="[[isTextField]]">
            <template is="dom-repeat" items="[[sentences]]" as="sentence">
                <paper-input label="[[sentence.label]]" on-value-changed="textHandler"></paper-input>
            </template>
        </template>

        <template is="dom-if" if="[[isOptionField]]">
            <template is="dom-repeat" items="[[sentences]]" as="sentence">
                <paper-dropdown-menu label="[[sentence.label]]" on-value-changed="optionSelectedHandler">
                    <paper-listbox slot="dropdown-content">
                        <template is="dom-repeat" items="[[sentence.options]]" as="option">
                            <paper-item>[[option]]</paper-item>
                        </template>
                    </paper-listbox>
                </paper-dropdown-menu>
            </template>
        </template>

        <template is="dom-if" if="[[isCheckboxField]]">
            <template is="dom-repeat" items="[[sentences]]" as="sentence">
                <h3>[[sentence.label]]</h3>
                <template is="dom-repeat" items="[[sentence.options]]" as="option">
                    <paper-checkbox>[[option]]</paper-checkbox>
                </template>
            </template>
        </template>

        <template is="dom-if" if="[[isRadioButtonField]]">
            <template is="dom-repeat" items="[[sentences]]" as="sentence">
                <h3>[[sentence.label]]</h3>
                <paper-radio-group>
                    <template is="dom-repeat" items="[[sentence.options]]" as="option">
                        <paper-radio-button name="[[option]]">[[option]]</paper-radio-button>
                    </template>
                </paper-radio-group>
            </template>
        </template>

    </template>

    <script>
        'use strict';
        (function PaperDynamicFormsDefinition(customElements) {
            /**
             * `paper-dynamic-forms`
             * This component gives a easy and comfortable way to magives a easy and comfortable way to make dynamics prohectske dynamics projects. E.g. polls
             *
             * @customElement
             * @polymer
             * @demo demo/index.html
             */
            class PaperDynamicForms extends Polymer.Element {
                static get is() {
                    return 'paper-dynamic-forms';
                }

                static get properties() {
                    return {
                        type: String,
                        sentences: {
                            type: Array
                        },
                        options: Array,
                        // Computed properties
                        isTextField: {
                            type: Boolean,
                            computed: '_isTextField(type)'
                        },
                        isOptionField: {
                            type: Boolean,
                            computed: '_isOptionField(type)'
                        },
                        isCheckboxField: {
                            type: Boolean,
                            computed: '_isCheckboxField(type)'
                        },
                        isRadioButtonField: {
                            type: Boolean,
                            computed: '_isRadioButtonField(type)'
                        }
                    };
                }

                optionSelectedHandler(event) {
                    let payload = {
                        model: event.model,
                        option: event.detail.value
                    };
                    this.dispatchEvent(new CustomEvent('option-input-response', {
                        bubbles: true,
                        composed: true,
                        detail: payload
                    }));
                }

                textHandler(event) {
                    let payload = {
                        model: event.model,
                        option: event.detail.value
                    };
                    this.dispatchEvent(new CustomEvent('text-input-response', {
                        bubbles: true,
                        composed: true,
                        detail: payload
                    }));
                }


                _isTextField(type) {
                    if (type === 'text-input') {
                        return true;
                    } else {
                        return false;
                    }
                }

                _isOptionField(type) {
                    if (type === 'option-input') {
                        return true;
                    } else {
                        return false;
                    }
                }

                _isCheckboxField(type) {
                    if (type === 'checkbox-input') {
                        return true;
                    } else {
                        return false;
                    }
                }

                _isRadioButtonField(type) {
                    if (type === 'radio-button-input') {
                        return true;
                    } else {
                        return false;
                    }
                }
            }

            customElements.define(PaperDynamicForms.is, PaperDynamicForms);
        })(window.customElements);
    </script>
</dom-module>
